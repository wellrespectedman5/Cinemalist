$(document).ready(function(){!function(){$.each($(".custom-it"),function(e,t){var a=$(this);a.hasClass("search-field")?a.chosen({placeholder_text_single:a.data("placeholder"),no_results_text:"Ничего не найдено!"}):a.chosen({placeholder_text_single:a.data("placeholder"),no_results_text:"Ничего не найдено!",disable_search_threshold:10})}),$.each($(".first-option-selected"),function(){var e=$(this);e.parent().find(".chosen-container").addClass("first-option-selected"),e.removeClass("first-option-selected")}),$(document).on("change",".aside-search__body .custom-it",function(){var e=$(this);e.children("option").first().prop("selected")?e.siblings(".chosen-container").addClass("first-option-selected"):e.siblings(".chosen-container").removeClass("first-option-selected")})}(),function(){$.each($(".simple-select"),function(e,t){var a=$(this);a.chosen({placeholder_text_single:a.data("placeholder"),no_results_text:"Ничего не найдено!",disable_search_threshold:10})})}(),function(){$(document).on("click",".js-input-tab",function(e){e.preventDefault();var t=$(this);t.closest(".input-group").toggleClass("form-toggle")})}(),function(){$(document).on("click",".js-popup-close",function(e){e.preventDefault(),$.fancybox.close()})}(),function(){$(document).on("click",".js-aside-full",function(e){e.preventDefault();var t=($(this),$(".global_wrapper"));t.toggleClass("aside--fullsize")})}(),function(){$(document).on("click",".js-menu-toggle",function(e){e.preventDefault();var t=$(this);t.parent().toggleClass("burger-toggle")})}(),function(){$(document).on("click",".js-toggle-step",function(e){e.preventDefault();var t=$(this),a=t.index(),s=$(".clapperboard-body");t.siblings().removeClass("is-active").end().addClass("is-active"),s.eq(a).length?s.removeClass("is-toggle").eq(a).addClass("is-toggle"):alert("Tab <"+a+"> not found")})}(),function(){$(document).on("click",".project .project-show_more",function(e){e.preventDefault();var t=$(this),a=t.parent();a.toggleClass("project-full"),a.hasClass("project-full")?t.html("Свернуть"):t.html("Развернуть")})}(),function(){$(document).on("click",".js-extended-search",function(e){e.preventDefault();var t=$(this);t.parent().toggleClass("is-open"),t.parent().hasClass("is-open")?t.html("Свернуть"):t.html("Рассширенный поиск")})}(),function(){$(document).on("click",".accordion__title",function(e){e.preventDefault();var t=$(this);t.parent().toggleClass("is-toggle"),t.parent().hasClass("is-toggle")})}(),function(){var e=$(".tabs");$.each(e,function(e,t){var a=$(this);a.find(".tabs__header").length&&a.find(".tabs__body").length?(a.find(".tabs__header-wrap").children(".tabs__header-item:first-child").addClass("is-active"),a.find(".tabs__body").children(".tabs__body-item:first-child").addClass("is-active"),a.find(".tabs__header-link").click(function(e){e.preventDefault();var t=$(this).parent(),s=t.index(),n=a.find(".tabs__body-item"),l=a.find(".tabs__header-item");return!t.hasClass("is-active")&&(n.removeClass("is-active"),l.removeClass("is-active"),t.addClass("is-active"),n.eq(s).addClass("is-active"),void 0)})):console.log("Tabs not found")})}(),function(){function e(e,t,a){var s=t,n=a/s;e.height(5*n);var l=$(window).width()>660?s*n/3:3*n;$(".people-preview__square").css({width:l,height:n,top:2*n})}var t=$(".people-preview__square");if(t.length){var a=function s(){var a=t.parent(),n=$(window).width(),l=$(window).width()>760?$(window).width()-$(".content-aside").width():$(window).width();return n>660?e(a,15,l):n<=660&&n>300&&e(a,5,l),s}();$(window).resize(function(){a()})}}(),function(){var e="<div class='comments-reply-form'> <form method='POST' action='/'><div class='input-group'><textarea name='comment-text' placeholder='Тут можно написать ваш комментарий'></textarea></div><input type='submit' class='button button--black' value='Отправить'><a href='#' class='comments__remove'>Отменить</a> </form></div>";$.fn.focusToEnd=function(){return this.each(function(){var e=$(this).val();$(this).focus().val("").val(e)})},$(document).on("click",".comments__reply",function(t){t.preventDefault(),$(".comments-reply-form").remove(),$(".js-reply-form").removeClass("js-reply-form");var a=$(this),s=a.parents(".author__info").find(".name").html().split(" ");a.closest(".comments__item,.comments__subitem").addClass("js-reply-form"),a.closest(".comments__item,.comments__subitem").append(e).find("textarea").html(s[0]+", "),a.closest(".comments__item,.comments__subitem").find("textarea").focusToEnd()}),$(document).on("click",".comments__remove",function(e){e.preventDefault(),$(".comments-reply-form").remove(),$(".js-reply-form").removeClass("js-reply-form")})}(),function(){var e=$(".js-faq-search");e.length&&($(document).on("focus",".js-faq-search",function(){var e=$(this);e.parents(".tabs__header").length&&(e.parents(".tabs__header").addClass("search-toggle"),e.attr("placeholder","Начать поиск"),$(".base-search-close").remove(),$(".base-search-body").remove(),e.parent().append("<a href='#' class='base-search-close'></a>"),e.closest(".tabs").find(".tabs__body").append("<div class='base-search-body'></div>"))}),$(document).on("blur",".js-faq-search",function(){var e=$(this);e.parents(".tabs__header").length&&e.parents(".tabs__header").hasClass("search-toggle")&&e.val().length<1&&(e.attr("placeholder","Поиск по базе знаний"),e.parents(".tabs__header").removeClass("search-toggle"))}),$(document).on("click",".base-search-close",function(e){e.preventDefault(),$(".js-faq-search").val("").attr("placeholder","Поиск по базе знаний"),$(this).closest(".tabs__header").removeClass("search-toggle")}))}(),function(){var e=$(".views");e.find(".view--table").addClass("is-toggle"),$(".people-view").find(".people-view__table").addClass("is-active"),$(document).on("click",".people-view a",function(t){t.preventDefault();var a=$(this);if(a.hasClass("is-active"))return!1;if($(".people-view a").removeClass("is-active"),a.addClass("is-active"),a.hasClass("js-view-toggle-list"))e.children().removeClass("is-toggle"),e.find(".view--list").addClass("is-toggle");else{if(!a.hasClass("js-view-toggle-table"))return!1;e.children().removeClass("is-toggle"),e.find(".view--table").addClass("is-toggle")}})}(),function(){var e=$(".checkbox-dropdown");if(e.length){var t=e.parent().children(".checkbox-wrap").children(".checkbox-square");t.click(function(){var e=$(this).parent().children("input[type='checkbox']:checked").length?0:1,t=$(this).parents(".checkbox-group").find(".checkbox-dropdown");e?(t.addClass("is-toggle"),console.log(1)):(t.removeClass("is-toggle"),console.log(0))})}}(),function(){$(document).on("click",".js-settings-next",function(e){e.preventDefault();var t=$(".tabs__header").children(".is-active").index();$(".tabs__header").children().eq(t+1).find(".tabs__header-link").click(),changeTab($(".tabs__header-wrap"),4)})}(),function(){$(document).on("change",".js-select-multiple",function(){var e=$(this),t=e.prop("name")+"-hidden",a=$(this).val(),s=e.parent();if(s.find(".selected-values").length||s.prepend("<div class='values-wrap'><ul class='selected-values'></ul><input type='hidden' name='"+t+"' /></div>"),"undefined"!=a){e.find("option[value='"+a+"']").attr("disabled",!0);e.find("option[value='"+a+"']").index();s.find(".chosen-results").length?e.trigger("chosen:updated"):console.log("without customize");var n=s.find(".selected-values"),l=s.find("input[name="+t+"]");l.val(l.val()+a+","),n.append("<li class='selected-values__item'><span class='selected-values__text'>"+a+"</span><a href='#' class='selected-value--remove'></a></li>")}})}(),function(){var e=$("[data-tooltip]"),t=$(window).width;t>760?$.each(e,function(){var e=$(this),t=e.data("tooltip-pos"),a=e.data("tooltip");$(this).tipso({width:"auto",background:"#fff",color:"#000",delay:100,speed:200,position:t,content:a})}):$.each(e,function(){var e=$(this),t=e.data("tooltip");$(this).tipso({width:"auto",background:"#fff",color:"#000",delay:100,speed:200,content:t}).end().css("text-align","left")})}(),function(){var e,t,a,s,n=$(".js-two-step-select"),l=n.find("#language-selects"),i={language:"",level:"",langVal:"",langLvl:""},o=[];$.each(n,function(){var n=$(this);!n.find("select:nth-of-type(1)").hasClass("js-first-step")&&n.find("select:nth-of-type(1)").addClass("js-first-step"),!n.find("select:nth-of-type(2)").hasClass("js-second-step")&&n.find("select:nth-of-type(2)").addClass("js-second-step"),e=n.find(".js-first-step"),t=n.find(".js-second-step"),e.on("change",function(){"undefined"!=$(this).val()&&""!=$(this).val()&&null!=$(this).val&&(a=e.find("option[value='"+$(this).val()+"']").html(),i.language=a,i.langVal=$(this).val(),d(n,i))}),t.on("change",function(){"undefined"!=$(this).val()&&""!=$(this).val()&&null!=$(this).val&&(s=t.find("option[value='"+$(this).val()+"']").html(),i.level=s,i.langLvl=$(this).val(),d(n,i))})});var r=function(e,t){var a=0;$(".selected-values").length?a++:$(e).find("label").after("<ul class='selected-values'></ul>");var s=$(".selected-values");s.empty();for(var n=0;n<=t.length-1;n++){var l=t[n].language+", "+t[n].level,i=t[n].langVal+":"+t[n].langLvl;s.append("<li class='selected-values__item' data-select-index='"+n+"'<span class='selected-values__text'>"+l+"</span><a href='#' class='selected-value--remove' data-string-value='"+i+"'></a></li>")}},c=function(){var a=e.children().first().val(),s=t.children().first().val();i={language:"",level:"",langVal:"",langLvl:""},e.val(a).trigger("chosen:updated"),t.val(s).trigger("chosen:updated")};$(document).on("click",".selected-value--remove",function(e){e.preventDefault();for(var t=$(this),a=t.parent(),s=t.data("string-value"),n=a.index(),l=t.parents(".js-two-step-select").find("input[type=hidden]"),i=l.val().split(","),c=i.length-1;c>=0;c--)i[c]===s&&i.splice(c,1);o.splice(n,1),$(".selected-values").empty(),r($(".selected-values"),o);var d=i;console.log(d),l.val(d)});var d=function(e,t){if("undefined"!=t.language&&""!=t.language&&"undefined"!=t.level&&""!=t.level){var a={};if(a.language=t.language,a.level=t.level,a.langVal=t.langVal,a.langLvl=t.langLvl,o.length){for(var s=!1,n=0;n<=o.length-1;n++)s=o[n].language==a.language;if(s)return c(),alert(t.language+"- language already selected"),!1;o.push(a),r(e,o),l.val(l.val()+(a.langVal+":"+a.langLvl)+","),c()}else o.push(a),r(e,o),l.val(l.val()+(a.langVal+":"+a.langLvl)+","),c()}}}(),function(){var e,t=$(".profile"),a=$(".content-body[data-default-blurmode]");const s=8;if(t.length){e=a.data("default-blurmode"),"daily"==e?(a.addClass("daily--mode"),$(".profile_mode--daily").addClass("is-active")):"nightly"==e&&(a.addClass("nightly--mode"),$(".profile_mode--nightly").addClass("is-active"));var n=t.find(".picture-wrap").children("img").attr("src");if("undefined"!=n){t.parent().prepend("<figure class='profile-blur'><canvas id='profile-blurred-bg' style='position: absolute; left:0;right:0;top:0;height: 100%;width: 100%;'></canvas></figure>");var l=document.querySelector("#profile-blurred-bg"),i=l.getContext("2d"),o=new Image;o.src=n;var r=function(){var e=l.width,t=l.height;i.drawImage(o,0,0,e,t),stackBlurCanvasRGBA("profile-blurred-bg",0,0,e,t,s)};o.onload=function(){r()}}}$(document).on("click",".profile_mode",function(e){e.preventDefault();var t=$(this);$(".profile-blur");return!t.hasClass("is-active")&&void(t.hasClass("profile_mode--daily")?(t.siblings().removeClass("is-active"),t.addClass("is-active"),a.removeClass("nightly--mode").addClass("daily--mode")):t.hasClass("profile_mode--nightly")&&(t.siblings().removeClass("is-active"),t.addClass("is-active"),a.removeClass("daily--mode").addClass("nightly--mode")))})}(),function(){$(document).on("click",".js-profile-form",function(e){e.preventDefault();var t=$(this),a="undefined"!=t.data("origin-text")?t.data("origin-text"):"none",s="undefined"!=t.data("changeto-text")?t.data("changeto-text"):"none",n=t.parents(".tabs__body-item").find(".profile-info-body"),l=t.parents(".tabs__body-item").find(".profile-info-form");n.hasClass("is-toggle")?(n.removeClass("is-toggle"),l.addClass("is-toggle"),t.children("i.plus-icon").css("transform","rotate(45deg)"),"none"!=s&&t.find("span").html(s)):(l.removeClass("is-toggle"),n.addClass("is-toggle"),t.children("i.plus-icon").css("transform","rotate(0deg)"),"none"!=a&&t.find("span").html(a))})}(),function(){var e=$(".tag-filter"),t=$(window).width()>1480?"inline-block":"block";e.length&&$(document).on("click",".tag-filter__list li a",function(e){e.preventDefault();var a=$(this),s=$(".tag-filter-body > li"),n=a.data("filter-id");a.parent().siblings().removeClass("is-active"),a.parent().addClass("is-active"),"all"!=n?$.each(s,function(){var e=$(this),a=e.data("filter-attr");a==n&&(console.log("filtering items with tags: "+a),s.css("display","none"),e.css("display",t))}):(console.log("filtering all items"),s.css("display",t))})}(),function(){var e=$(".js-letter-toggle");e.length&&$(document).on("click",".js-letter-toggle",function(e){e.preventDefault();var t=$(this),a="Написать сопроводительное письмо",s="Скрыть",n=t.parent();console.log(a),t.parent().toggleClass("is-toggle"),n.hasClass("is-toggle")?t.children("span").html(s):t.children("span").html(a)})}(),function(){var e=$(".people-preview__list");e.length&&(e.find("img").gray(),$(document).on("mouseenter",".people-preview__list img",function(){$(this).addClass("grayscale-off")}),$(document).on("mouseleave",".people-preview__list img",function(){$(this).removeClass("grayscale-off")}))}(),function(){function e(e){var t=e.offsetWidth,a=getComputedStyle(e);return t+=parseInt(a.marginLeft)+parseInt(a.marginRight)}var t=$(window).width(),a=$(".tabs__header-wrap"),s=0,n=[];$.each(a.children(),function(){s+=e($(this)[0])+15,n.push(s)}),console.log(n),t<s&&a.length&&(a.css({overflow:"auto","overflow-y":"hidden","-webkit-overflow-scrolling":"touch","-ms-overflow-style":"-ms-autohiding-scrollbar","padding-bottom":"20px"}),a.parent().css({overflow:"hidden",height:"34px"}))}(),$(document).mouseup(function(e){var t=$(".global_wrapper.aside--fullsize");t.is(e.target)||0!==t.has(e.target).length||t.removeClass("aside--fullsize")}),function(){$(".popup-call").fancybox({padding:0,overlayOpacity:.5,overlayColor:"#000",transitionIn:"none",transitionOut:"none",titlePosition:"inside",centerOnScroll:!0,maxWidth:800})}()});